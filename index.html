<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mon Mariage ‚Äî Suivi</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

 <style>
  :root{
    /* Palette chic minimaliste */
    --ivory:#F8FAFC;
    --ivory-2:#F1F5F9;
    --navy:#0F172A;
    --gold:#C8A96A;
    --gold-2:#B99656;
    --text:#111827;
    --muted:#64748B;
    --line:#E5E7EB;

    /* Effets premium */
    --shadow-1: 0 10px 30px rgba(15,23,42,.06);
    --shadow-2: 0 18px 45px rgba(15,23,42,.10);
    --radius: 18px;
    --radius-lg: 22px;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
  font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  color: var(--text);

  /* BACKGROUND P√âTILLANT PREMIUM */
  background:
    /* Rose poudr√© lumineux (√©motion / mariage) */
    radial-gradient(
      700px 500px at 15% -10%,
      rgba(255,183,197,.45),
      rgba(255,183,197,0) 65%
    ),

    /* Or lumineux (prestige / c√©l√©bration) */
    radial-gradient(
      650px 450px at 85% 5%,
      rgba(200,169,106,.50),
      rgba(200,169,106,0) 70%
    ),

    /* Bleu ciel doux (fra√Æcheur / joie) */
    radial-gradient(
      800px 550px at 50% 35%,
      rgba(147,197,253,.35),
      rgba(147,197,253,0) 65%
    ),

    /* Violet tr√®s l√©ger (romance moderne) */
    radial-gradient(
      600px 400px at 90% 60%,
      rgba(196,181,253,.30),
      rgba(196,181,253,0) 65%
    ),

    /* D√©grad√© de base color√© */
    linear-gradient(
      180deg,
      #FFF1F5 0%,
      #FDF4FF 35%,
      #F0F9FF 65%,
      #ECFEFF 100%
    );
}
body::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    radial-gradient(rgba(255,255,255,.25) 1px, transparent 1px);
  background-size: 22px 22px;
  opacity: .35;
}
.card,
.hero-card{
  background: rgba(255,255,255,.82);
  backdrop-filter: blur(14px);
}
.section-title{
  background: linear-gradient(90deg, #0F172A, #C8A96A);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}



  /* App container */
  .app{
    max-width: 430px;
    margin: 0 auto;
    min-height: 100vh;
    padding-bottom: 92px; /* bottom nav */
  }

  /* Topbar */
  .topbar{
    position: sticky;
    top: 0;
    z-index: 10;
    padding: 16px 16px 12px;
    background: rgba(248,250,252,.82);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(229,231,235,.8);
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap: 12px;
  }
  .topbar h1{
    font-size: 22px;
    font-weight: 900;
    color: var(--navy);
    letter-spacing: -0.4px;
    line-height: 1.1;
  }
  .sub{
    margin-top: 4px;
    font-size: 12px;
    color: var(--muted);
  }

  .icon-btn{
    border: 1px solid rgba(229,231,235,.9);
    background: rgba(255,255,255,.85);
    border-radius: 14px;
    padding: 10px 12px;
    cursor:pointer;
    box-shadow: var(--shadow-1);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .icon-btn:active{transform: scale(.98)}
  .icon-btn:hover{box-shadow: var(--shadow-2)}

  /* Pages */
  .pages{padding: 14px 16px 20px}
  .page{display:none; animation: fadeUp .18s ease}
  .page.active{display:block}
  @keyframes fadeUp{
    from{opacity:.0; transform: translateY(6px)}
    to{opacity:1; transform: translateY(0)}
  }

  /* Titles */
  h2{
    font-size: 18px;
    color: var(--navy);
    font-weight: 900;
    letter-spacing: -0.2px;
    margin: 0 0 10px;
  }
  .section-title{
    margin: 18px 0 10px;
    font-size: 14px;
    font-weight: 900;
    color: var(--navy);
  }

  /* Card base */
  .card{
    background: rgba(255,255,255,.92);
    border: 1px solid rgba(229,231,235,.9);
    border-radius: var(--radius);
    box-shadow: var(--shadow-1);
    padding: 14px;
  }

  /* Hero / Countdown card */
  .hero-card{
    position: relative;
    border-radius: var(--radius-lg);
    padding: 16px;
    border: 1px solid rgba(229,231,235,.9);
    background:
      linear-gradient(135deg, rgba(255,255,255,.95), rgba(255,255,255,.80));
    box-shadow: var(--shadow-2);
    overflow: hidden;
    display:flex;
    justify-content:space-between;
    gap: 12px;
  }
  /* subtle decorative blur */
  .hero-card::before{
    content:"";
    position:absolute;
    width: 180px;
    height: 180px;
    right: -70px;
    top: -70px;
    background: radial-gradient(circle, rgba(200,169,106,.35), rgba(200,169,106,0) 70%);
    filter: blur(2px);
  }
  .hero-card::after{
    content:"";
    position:absolute;
    width: 220px;
    height: 220px;
    left: -90px;
    bottom: -110px;
    background: radial-gradient(circle, rgba(15,23,42,.14), rgba(15,23,42,0) 65%);
    filter: blur(1px);
  }

  .label{font-size:12px;color:var(--muted)}
  .big{
    font-size: 40px;
    font-weight: 950;
    color: var(--navy);
    letter-spacing: -1px;
    margin: 6px 0 10px;
    position: relative;
    z-index: 1;
  }

  /* Progress */
  .progress-wrap{margin-top:4px; position: relative; z-index: 1;}
  .progress-bar{
    width:100%;
    height: 10px;
    border-radius: 999px;
    background: rgba(241,245,249,.9);
    border: 1px solid rgba(229,231,235,.9);
    overflow:hidden;
  }
  .progress-fill{
    height:100%;
    width:0%;
    border-radius: 999px;
    background: linear-gradient(90deg, var(--gold), var(--gold-2));
    box-shadow: 0 6px 14px rgba(200,169,106,.30);
    transition: width .35s ease;
  }
  .progress-meta{
    margin-top: 8px;
    font-size: 12px;
    color: var(--muted);
  }

  .hero-right{
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    gap: 10px;
    position: relative;
    z-index: 1;
  }

  .chip{
    font-size: 11px;
    font-weight: 800;
    letter-spacing: .1px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(229,231,235,.9);
    background: rgba(255,255,255,.80);
    box-shadow: 0 10px 20px rgba(15,23,42,.06);
  }

  .mini-stats{display:flex;gap:10px}
  .mini{
    background: rgba(255,255,255,.86);
    border: 1px solid rgba(229,231,235,.9);
    border-radius: 16px;
    padding: 10px 12px;
    min-width: 110px;
    text-align:right;
    box-shadow: 0 10px 22px rgba(15,23,42,.06);
  }
  .mini-title{display:block;color:var(--muted);font-size:11px}
  .mini-value{
    display:block;
    font-weight: 950;
    color: var(--navy);
    font-size: 18px;
    letter-spacing: -0.3px;
  }

  /* Grid */
  .grid-2{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  /* Stat cards */
  .stat{
    padding: 14px;
    border-radius: 18px;
    background: rgba(255,255,255,.92);
  }
  .stat .value{
    margin-top: 6px;
    font-size: 15px;
    font-weight: 950;
    color: var(--navy);
    letter-spacing: -0.2px;
  }

  /* Buttons */
  .btn{
    border-radius: 999px;
    padding: 10px 14px;
    border: 1px solid transparent;
    font-weight: 850;
    cursor:pointer;
    font-size: 13px;
    transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
  }
  .btn:active{transform: scale(.99)}
  .btn-primary{
    background: linear-gradient(135deg, var(--gold), var(--gold-2));
    color: #121212;
    box-shadow: 0 14px 30px rgba(200,169,106,.26);
  }
  .btn-primary:hover{filter: brightness(1.02)}
  .btn-outline{
    background: rgba(255,255,255,.92);
    border-color: rgba(229,231,235,.95);
    color: var(--navy);
    box-shadow: 0 10px 20px rgba(15,23,42,.06);
  }
  .btn-full{width:100%}

  /* Lists */
  .list{list-style:none;display:flex;flex-direction:column;gap:10px;margin-top:6px}
  .item{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    padding: 12px 12px;
    border: 1px solid rgba(229,231,235,.9);
    border-radius: 16px;
    background: rgba(255,255,255,.95);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .item:hover{
    box-shadow: 0 14px 30px rgba(15,23,42,.08);
    transform: translateY(-1px);
  }

  .item-left{display:flex;align-items:flex-start;gap:10px}
  .item-title{font-weight:950;color:var(--navy);font-size:13px;letter-spacing:-0.15px}
  .item-sub{color:var(--muted);font-size:11px;margin-top:2px}

  .dot{
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--gold), var(--gold-2));
    margin-top: 5px;
    box-shadow: 0 10px 18px rgba(200,169,106,.25);
  }

  .badge{
    font-size: 11px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(229,231,235,.9);
    background: rgba(255,255,255,.9);
    color: var(--navy);
    font-weight: 900;
    box-shadow: 0 10px 20px rgba(15,23,42,.06);
  }

  .mini-btn{
    border-radius: 999px;
    border: 1px solid rgba(229,231,235,.95);
    background: rgba(255,255,255,.92);
    padding: 8px 12px;
    cursor:pointer;
    font-weight: 900;
    font-size: 12px;
    color: var(--navy);
    white-space: nowrap;
    box-shadow: 0 10px 18px rgba(15,23,42,.06);
    transition: transform .12s ease, box-shadow .12s ease;
  }
  .mini-btn:hover{box-shadow: 0 16px 30px rgba(15,23,42,.10)}
  .mini-btn:active{transform: scale(.98)}
  .mini-btn.danger{
    color:#b42318;
    border-color:#ffd7d7;
    background:#fff6f6;
    box-shadow: 0 12px 22px rgba(180,35,24,.10);
  }

  /* Pills & dividers */
  .muted{color:var(--muted);font-size:13px}
  .mt{margin-top:12px}
  .mt-sm{margin-top:8px}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .pill{
    border: 1px solid rgba(229,231,235,.9);
    background: rgba(255,255,255,.92);
    border-radius: 999px;
    padding: 8px 10px;
    font-size: 12px;
    color: var(--navy);
    box-shadow: 0 10px 20px rgba(15,23,42,.06);
  }
  .divider{height:1px;background:rgba(229,231,235,.9);margin:12px 0}

  /* Bottom nav (floating premium) */
  .bottom-nav{
    position: fixed;
    left: 50%;
    transform: translateX(-50%);
    bottom: 10px;
    width: min(430px, calc(100% - 24px));
    display:flex;
    gap: 8px;
    justify-content:space-between;
    padding: 10px;
    background: rgba(255,255,255,.86);
    backdrop-filter: blur(14px);
    border: 1px solid rgba(229,231,235,.9);
    border-radius: 22px;
    box-shadow: 0 18px 45px rgba(15,23,42,.14);
  }

  .tab{
    flex:1;
    border: 1px solid rgba(229,231,235,.85);
    background: rgba(255,255,255,.92);
    border-radius: 16px;
    padding: 10px 6px;
    cursor:pointer;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap: 4px;
    font-size: 14px;
    transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .tab span{font-size:10px;font-weight:900;color:var(--muted)}
  .tab:hover{
    transform: translateY(-1px);
    box-shadow: 0 12px 26px rgba(15,23,42,.10);
  }
  .tab.active{
    border-color: rgba(200,169,106,.70);
    box-shadow: 0 16px 34px rgba(200,169,106,.22);
    background: linear-gradient(135deg, rgba(200,169,106,.18), rgba(255,255,255,.92));
  }
  .tab.active span{color: var(--navy)}

  /* Modals / sheet (more premium) */
  .modal{
    position: fixed;
    inset: 0;
    background: rgba(15,23,42,.52);
    display:none;
    align-items:flex-end;
    justify-content:center;
    padding: 14px;
    z-index: 50;
  }
  .modal.open{display:flex}

  .sheet{
    width: min(430px, 100%);
    background: rgba(255,255,255,.94);
    border-radius: 24px;
    border: 1px solid rgba(229,231,235,.9);
    box-shadow: 0 22px 60px rgba(15,23,42,.22);
    overflow:hidden;
  }
  .sheet-head{
    padding: 14px 14px 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom: 1px solid rgba(229,231,235,.9);
    background: rgba(248,250,252,.80);
  }
  .sheet-head h3{font-size:14px;font-weight:950;color:var(--navy)}

  .form{padding: 14px; display:flex; flex-direction:column; gap: 10px}
  label{
    font-size:12px;
    color:var(--navy);
    font-weight:900;
    display:flex;
    flex-direction:column;
    gap:6px
  }
  input, select{
    width: 100%;
    border-radius: 16px;
    border: 1px solid rgba(229,231,235,.95);
    padding: 12px 12px;
    font: inherit;
    font-size: 13px;
    outline: none;
    background: rgba(255,255,255,.95);
    box-shadow: 0 10px 20px rgba(15,23,42,.05);
    transition: border-color .12s ease, box-shadow .12s ease;
  }
  input:focus, select:focus{
    border-color: rgba(200,169,106,.80);
    box-shadow: 0 0 0 4px rgba(200,169,106,.18), 0 10px 20px rgba(15,23,42,.06);
  }
  .row-inline{flex-direction:row;align-items:center;gap:10px;font-weight:800;color:var(--muted)}
  .row-inline input{width:auto}

  /* Mobile small devices */
  @media (max-width: 360px){
    .grid-2{grid-template-columns: 1fr}
    .mini-stats{flex-direction:column; align-items:stretch}
    .mini{text-align:left; min-width:auto}
  }
</style>

</head>

<body>
  <div class="app">
    <header class="topbar">
      <div>
        <h1>Mon Mariage</h1>
        <p class="sub">Suivi chic minimaliste</p>
      </div>
      <button class="icon-btn" id="openSettings" aria-label="Param√®tres">‚öôÔ∏è</button>
    </header>

    <main class="pages">
      <!-- Accueil -->
      <section class="page active" id="page-home" aria-label="Accueil">
        <div class="hero-card">
          <div class="hero-left">
            <p class="label">Compte √† rebours</p>
            <div class="big" id="countdown">J-‚Äî</div>
            <div class="progress-wrap">
              <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width:0%"></div>
              </div>
              <div class="progress-meta" id="progressMeta">0% termin√© ‚Ä¢ 0/0 t√¢ches</div>
            </div>
          </div>
          <div class="hero-right">
            <div class="chip">‚ú® Chic minimaliste</div>
            <div class="mini-stats">
              <div class="mini">
                <span class="mini-title">Invit√©s</span>
                <span class="mini-value" id="guestsCount">0</span>
              </div>
              <div class="mini">
                <span class="mini-title">Demoiselles</span>
                <span class="mini-value" id="bridesmaidsCount">0</span>
              </div>
            </div>
          </div>
        </div>

        <h2 class="section-title">R√©sum√© finances</h2>
        <div class="grid-2">
          <div class="card stat">
            <p class="label">Montant de base</p>
            <p class="value" id="budgetBase">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">En caisse</p>
            <p class="value" id="cashOnHand">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Ce que je dois avoir</p>
            <p class="value" id="targetAmount">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Total d√©pens√©</p>
            <p class="value" id="totalSpent">‚Äî</p>
          </div>
        </div>

        <h2 class="section-title">√Ä faire prochainement</h2>
        <div class="card">
          <ul class="list" id="nextTasks"></ul>
        </div>
      </section>

      <!-- Checklist (placeholder) -->
      <section class="page" id="page-checklist" aria-label="Checklist">
        <h2>Checklist</h2>
        <div class="card">
          <p class="muted">
            (Prochaine √©tape) Ici on mettra toutes les t√¢ches par cat√©gories + dates + statuts.
          </p>
        </div>
      </section>

      <!-- Budget -->
      <section class="page" id="page-budget" aria-label="Budget">
        <div class="page-head">
          <h2>Budget</h2>
          <button class="btn btn-primary" id="openAddExpense">+ D√©pense</button>
        </div>

        <div class="grid-2">
          <div class="card stat">
            <p class="label">Montant de base</p>
            <p class="value" id="b_budgetBase">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Ce que j‚Äôai en caisse</p>
            <p class="value" id="b_cashOnHand">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Ce que je dois avoir</p>
            <p class="value" id="b_targetAmount">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Total d√©pens√©</p>
            <p class="value" id="b_totalSpent">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Reste sur budget</p>
            <p class="value" id="b_remaining">‚Äî</p>
          </div>
          <div class="card stat">
            <p class="label">Manque √† atteindre</p>
            <p class="value" id="b_missingToTarget">‚Äî</p>
          </div>
        </div>

        <h2 class="section-title">D√©penses</h2>
        <div class="card">
          <ul class="list" id="expensesList"></ul>
        </div>
      </section>

      <!-- Invit√©s -->
      <section class="page" id="page-guests" aria-label="Invit√©s">
        <div class="page-head">
          <h2>Invit√©s</h2>
          <button class="btn btn-primary" id="openAddGuest">+ Invit√©</button>
        </div>

        <div class="card">
          <div class="row">
            <div class="pill">Total : <strong id="g_total">0</strong></div>
            <div class="pill">Confirm√©s : <strong id="g_confirmed">0</strong></div>
            <div class="pill">En attente : <strong id="g_pending">0</strong></div>
          </div>

          <div class="divider"></div>

          <ul class="list" id="guestsList"></ul>
        </div>

        <div class="card mt">
          <h3 style="font-size:14px;font-weight:900;color:var(--navy);">Demoiselles d‚Äôhonneur</h3>
          <p class="muted">Ajoute ici les demoiselles d‚Äôhonneur (elles comptent aussi dans les invit√©s).</p>
          <button class="btn btn-outline" id="openAddBridesmaid">+ Demoiselle d‚Äôhonneur</button>
          <ul class="list mt-sm" id="bridesmaidsList"></ul>
        </div>
      </section>

      <!-- Inspirations (placeholder) -->
      <section class="page" id="page-inspi" aria-label="Inspirations">
        <h2>Inspirations</h2>
        <div class="card">
          <p class="muted">
            (Prochaine √©tape) Moodboard : robe, faire-part, alliances, d√©co‚Ä¶
          </p>
        </div>
      </section>
    </main>

    <nav class="bottom-nav" aria-label="Navigation">
      <button class="tab active" data-go="home">üè†<span>Accueil</span></button>
      <button class="tab" data-go="checklist">‚úÖ<span>Checklist</span></button>
      <button class="tab" data-go="budget">üí∞<span>Budget</span></button>
      <button class="tab" data-go="guests">üë•<span>Invit√©s</span></button>
      <button class="tab" data-go="inspi">üñºÔ∏è<span>Inspi</span></button>
    </nav>
  </div>

  <!-- MODAL: Param√®tres -->
  <div class="modal" id="settingsModal" role="dialog" aria-modal="true" aria-label="Param√®tres">
    <div class="sheet">
      <div class="sheet-head">
        <h3>Param√®tres</h3>
        <button class="icon-btn" data-close="settingsModal">‚úï</button>
      </div>

      <form id="settingsForm" class="form">
        <label>
          Date du mariage
          <input type="date" id="weddingDate" required />
        </label>

        <div class="grid-2">
          <label>
            Montant de base (FCFA)
            <input type="number" id="budgetBaseInput" min="0" step="1" required />
          </label>
          <label>
            En caisse (FCFA)
            <input type="number" id="cashOnHandInput" min="0" step="1" required />
          </label>
        </div>

        <div class="grid-2">
          <label>
            Objectif √† atteindre (FCFA)
            <input type="number" id="targetAmountInput" min="0" step="1" required />
          </label>
          <label>
            Date objectif (option)
            <input type="date" id="targetDateInput" />
          </label>
        </div>

        <button class="btn btn-primary btn-full" type="submit">Enregistrer</button>
      </form>
    </div>
  </div>

  <!-- MODAL: Ajouter d√©pense -->
  <div class="modal" id="expenseModal" role="dialog" aria-modal="true" aria-label="Ajouter une d√©pense">
    <div class="sheet">
      <div class="sheet-head">
        <h3>Ajouter une d√©pense</h3>
        <button class="icon-btn" data-close="expenseModal">‚úï</button>
      </div>

      <form id="expenseForm" class="form">
        <label>
          Montant (FCFA)
          <input type="number" id="expenseAmount" min="0" step="1" required />
        </label>

        <label>
          Cat√©gorie
          <select id="expenseCategory" required>
            <option value="Salle">Salle</option>
            <option value="Traiteur">Traiteur</option>
            <option value="Tenues">Tenues</option>
            <option value="D√©coration">D√©coration</option>
            <option value="Photo/Vid√©o">Photo/Vid√©o</option>
            <option value="DJ/Musique">DJ/Musique</option>
            <option value="Administratif">Administratif</option>
            <option value="Autres">Autres</option>
          </select>
        </label>

        <label>
          Note (option)
          <input type="text" id="expenseNote" placeholder="ex: acompte salle" />
        </label>

        <label class="row-inline">
          <input type="checkbox" id="expensePaid" checked />
          Pay√©
        </label>

        <button class="btn btn-primary btn-full" type="submit">Ajouter</button>
      </form>
    </div>
  </div>

  <!-- MODAL: Ajouter invit√© -->
  <div class="modal" id="guestModal" role="dialog" aria-modal="true" aria-label="Ajouter un invit√©">
    <div class="sheet">
      <div class="sheet-head">
        <h3>Ajouter un invit√©</h3>
        <button class="icon-btn" data-close="guestModal">‚úï</button>
      </div>

      <form id="guestForm" class="form">
        <label>
          Nom
          <input type="text" id="guestName" required />
        </label>

        <label>
          T√©l√©phone (option)
          <input type="tel" id="guestPhone" placeholder="+241..." />
        </label>

        <div class="grid-2">
          <label>
            Groupe
            <select id="guestGroup">
              <option value="Famille">Famille</option>
              <option value="Amis">Amis</option>
              <option value="Coll√®gues">Coll√®gues</option>
              <option value="Invit√©s">Invit√©s</option>
            </select>
          </label>

          <label>
            RSVP
            <select id="guestRsvp">
              <option value="pending">En attente</option>
              <option value="confirmed">Confirm√©</option>
              <option value="declined">Refus</option>
            </select>
          </label>
        </div>

        <button class="btn btn-primary btn-full" type="submit">Ajouter</button>
      </form>
    </div>
  </div>

  <!-- MODAL: Ajouter demoiselle d‚Äôhonneur -->
  <div class="modal" id="bridesmaidModal" role="dialog" aria-modal="true" aria-label="Ajouter une demoiselle d‚Äôhonneur">
    <div class="sheet">
      <div class="sheet-head">
        <h3>Ajouter une demoiselle d‚Äôhonneur</h3>
        <button class="icon-btn" data-close="bridesmaidModal">‚úï</button>
      </div>

      <form id="bridesmaidForm" class="form">
        <label>
          Nom
          <input type="text" id="bmName" required />
        </label>
        <label>
          T√©l√©phone (option)
          <input type="tel" id="bmPhone" placeholder="+241..." />
        </label>
        <label>
          Notes tenue (option)
          <input type="text" id="bmNotes" placeholder="couleur, style..." />
        </label>
        <button class="btn btn-primary btn-full" type="submit">Ajouter</button>
      </form>
    </div>
  </div>

  <script>
    const KEY = "wedding_app_v1";

    function formatMoney(n){
      try { return new Intl.NumberFormat("fr-FR").format(n) + " FCFA"; }
      catch { return n + " FCFA"; }
    }

    function todayISO(){
      const d = new Date();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      return `${d.getFullYear()}-${m}-${day}`;
    }

    function daysUntil(dateISO){
      const target = new Date(dateISO + "T00:00:00");
      const now = new Date();
      const diff = target.getTime() - new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
      return Math.max(0, Math.ceil(diff / (1000*60*60*24)));
    }

    function loadState(){
      const raw = localStorage.getItem(KEY);
      if(raw) return JSON.parse(raw);

      const weddingDate = new Date();
      weddingDate.setDate(weddingDate.getDate() + 120);
      const wdISO = weddingDate.toISOString().slice(0,10);

      const state = {
        profile: {
          weddingDate: wdISO,
          budgetBase: 3000000,
          cashOnHand: 500000,
          targetAmount: 2000000,
          targetDate: ""
        },
        tasks: [
          { title: "Fixer la date", category: "Annonce & date", status: "todo" },
          { title: "√âtablir la liste des invit√©s", category: "Invitations", status: "todo" },
          { title: "Choisir le mod√®le de robe", category: "Tenues", status: "todo" },
          { title: "Comparer les traiteurs", category: "Prestataires", status: "todo" }
        ],
        expenses: [
          { amount: 50000, category: "Administratif", date: todayISO(), note: "Dossier / photocopies", isPaid: true }
        ],
        guests: [
          { name: "Maman", phone: "", group: "Famille", rsvp: "confirmed" },
          { name: "Papa", phone: "", group: "Famille", rsvp: "confirmed" },
          { name: "Tante Sarah", phone: "", group: "Famille", rsvp: "pending" },
          { name: "Ami proche", phone: "", group: "Amis", rsvp: "pending" }
        ],
        bridesmaids: [
          { name: "Meilleure amie", phone: "", notes: "Demoiselle d‚Äôhonneur", status: "pending" }
        ]
      };

      localStorage.setItem(KEY, JSON.stringify(state));
      return state;
    }

    function saveState(state){
      localStorage.setItem(KEY, JSON.stringify(state));
    }

    const tabs = document.querySelectorAll(".tab");
    const pages = {
      home: document.getElementById("page-home"),
      checklist: document.getElementById("page-checklist"),
      budget: document.getElementById("page-budget"),
      guests: document.getElementById("page-guests"),
      inspi: document.getElementById("page-inspi"),
    };

    function go(pageKey){
      Object.values(pages).forEach(p => p.classList.remove("active"));
      pages[pageKey].classList.add("active");
      tabs.forEach(t => t.classList.toggle("active", t.dataset.go === pageKey));
    }

    function openModal(id){ document.getElementById(id).classList.add("open"); }
    function closeModal(id){ document.getElementById(id).classList.remove("open"); }

    document.addEventListener("click", (e) => {
      const closeId = e.target?.dataset?.close;
      if(closeId) closeModal(closeId);
      if(e.target.classList.contains("modal")) e.target.classList.remove("open");
    });

    function labelRsvp(v){
      if(v === "confirmed") return "Confirm√©";
      if(v === "declined") return "Refus";
      return "En attente";
    }

    function escapeHtml(s){
      return String(s ?? "").replace(/[&<>"']/g, (m) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[m]));
    }

    function render(){
      const state = loadState();
      const { profile, tasks, expenses, guests, bridesmaids } = state;

      document.getElementById("countdown").textContent = "J-" + daysUntil(profile.weddingDate);

      const done = tasks.filter(t => t.status === "done").length;
      const pct = tasks.length ? Math.round((done / tasks.length) * 100) : 0;
      document.getElementById("progressFill").style.width = pct + "%";
      document.getElementById("progressMeta").textContent = `${pct}% termin√© ‚Ä¢ ${done}/${tasks.length} t√¢ches`;

      document.getElementById("guestsCount").textContent = guests.length;
      document.getElementById("bridesmaidsCount").textContent = bridesmaids.length;

      const totalSpent = expenses.reduce((s,e)=>s + Number(e.amount||0), 0);
      const remaining = Math.max(0, profile.budgetBase - totalSpent);
      const missingToTarget = Math.max(0, profile.targetAmount - profile.cashOnHand);

      const setText = (id, val) => document.getElementById(id).textContent = val;

      setText("budgetBase", formatMoney(profile.budgetBase));
      setText("cashOnHand", formatMoney(profile.cashOnHand));
      setText("targetAmount", formatMoney(profile.targetAmount));
      setText("totalSpent", formatMoney(totalSpent));

      setText("b_budgetBase", formatMoney(profile.budgetBase));
      setText("b_cashOnHand", formatMoney(profile.cashOnHand));
      setText("b_targetAmount", formatMoney(profile.targetAmount));
      setText("b_totalSpent", formatMoney(totalSpent));
      setText("b_remaining", formatMoney(remaining));
      setText("b_missingToTarget", formatMoney(missingToTarget));

      const next = tasks.filter(t => t.status !== "done").slice(0,4);
      const ulNext = document.getElementById("nextTasks");
      ulNext.innerHTML = "";
      if(!next.length){
        ulNext.innerHTML = `<li class="item muted">Aucune t√¢che en attente üéâ</li>`;
      } else {
        next.forEach(t => {
          const li = document.createElement("li");
          li.className = "item";
          li.innerHTML = `
            <div class="item-left">
              <span class="dot"></span>
              <div>
                <div class="item-title">${escapeHtml(t.title)}</div>
                <div class="item-sub">${escapeHtml(t.category)}</div>
              </div>
            </div>
            <button class="mini-btn" data-done="${escapeHtml(t.title)}">Fait</button>
          `;
          ulNext.appendChild(li);
        });
      }

      const expUl = document.getElementById("expensesList");
      expUl.innerHTML = "";
      if(!expenses.length){
        expUl.innerHTML = `<li class="item muted">Aucune d√©pense.</li>`;
      } else {
        expenses.slice().reverse().forEach((e, idxFromEnd) => {
          const li = document.createElement("li");
          li.className = "item";
          li.innerHTML = `
            <div class="item-left">
              <div class="badge">${escapeHtml(e.category)}</div>
              <div>
                <div class="item-title">${formatMoney(Number(e.amount||0))}</div>
                <div class="item-sub">${escapeHtml(e.note || e.date)}</div>
              </div>
            </div>
            <button class="mini-btn danger" data-del-exp="${expenses.length-1-idxFromEnd}">Suppr</button>
          `;
          expUl.appendChild(li);
        });
      }

      const confirmed = guests.filter(g => g.rsvp === "confirmed").length;
      const pending = guests.filter(g => g.rsvp === "pending").length;

      setText("g_total", guests.length);
      setText("g_confirmed", confirmed);
      setText("g_pending", pending);

      const gUl = document.getElementById("guestsList");
      gUl.innerHTML = "";
      if(!guests.length){
        gUl.innerHTML = `<li class="item muted">Aucun invit√©.</li>`;
      } else {
        guests.forEach((g, i) => {
          const li = document.createElement("li");
          li.className = "item";
          li.innerHTML = `
            <div class="item-left">
              <div>
                <div class="item-title">${escapeHtml(g.name)}</div>
                <div class="item-sub">${escapeHtml(g.group)} ‚Ä¢ ${labelRsvp(g.rsvp)} ${g.phone ? "‚Ä¢ " + escapeHtml(g.phone) : ""}</div>
              </div>
            </div>
            <button class="mini-btn danger" data-del-guest="${i}">Suppr</button>
          `;
          gUl.appendChild(li);
        });
      }

      const bmUl = document.getElementById("bridesmaidsList");
      bmUl.innerHTML = "";
      if(!bridesmaids.length){
        bmUl.innerHTML = `<li class="item muted">Aucune demoiselle d‚Äôhonneur ajout√©e.</li>`;
      } else {
        bridesmaids.forEach((b, i) => {
          const li = document.createElement("li");
          li.className = "item";
          li.innerHTML = `
            <div class="item-left">
              <div>
                <div class="item-title">${escapeHtml(b.name)}</div>
                <div class="item-sub">${escapeHtml(b.notes || "Demoiselle d‚Äôhonneur")} ${b.phone ? "‚Ä¢ " + escapeHtml(b.phone) : ""}</div>
              </div>
            </div>
            <button class="mini-btn danger" data-del-bm="${i}">Suppr</button>
          `;
          bmUl.appendChild(li);
        });
      }

      document.getElementById("weddingDate").value = profile.weddingDate;
      document.getElementById("budgetBaseInput").value = profile.budgetBase;
      document.getElementById("cashOnHandInput").value = profile.cashOnHand;
      document.getElementById("targetAmountInput").value = profile.targetAmount;
      document.getElementById("targetDateInput").value = profile.targetDate || "";
    }

    document.querySelectorAll("[data-go]").forEach(btn=>{
      btn.addEventListener("click", ()=> go(btn.dataset.go));
    });

    document.getElementById("openSettings").addEventListener("click", ()=> openModal("settingsModal"));
    document.getElementById("openAddExpense").addEventListener("click", ()=> openModal("expenseModal"));
    document.getElementById("openAddGuest").addEventListener("click", ()=> openModal("guestModal"));
    document.getElementById("openAddBridesmaid").addEventListener("click", ()=> openModal("bridesmaidModal"));

    document.addEventListener("click", (e) => {
      const title = e.target?.dataset?.done;
      if(!title) return;
      const state = loadState();
      const t = state.tasks.find(x => x.title === title && x.status !== "done");
      if(t){ t.status = "done"; saveState(state); render(); }
    });

    document.addEventListener("click", (e) => {
      const idx = e.target?.dataset?.delExp;
      if(idx === undefined) return;
      const state = loadState();
      state.expenses.splice(Number(idx), 1);
      saveState(state);
      render();
    });

    document.addEventListener("click", (e) => {
      const idx = e.target?.dataset?.delGuest;
      if(idx === undefined) return;
      const state = loadState();
      state.guests.splice(Number(idx), 1);
      saveState(state);
      render();
    });

    document.addEventListener("click", (e) => {
      const idx = e.target?.dataset?.delBm;
      if(idx === undefined) return;
      const state = loadState();
      state.bridesmaids.splice(Number(idx), 1);
      saveState(state);
      render();
    });

    document.getElementById("settingsForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const state = loadState();
      state.profile.weddingDate = document.getElementById("weddingDate").value;
      state.profile.budgetBase = Number(document.getElementById("budgetBaseInput").value || 0);
      state.profile.cashOnHand = Number(document.getElementById("cashOnHandInput").value || 0);
      state.profile.targetAmount = Number(document.getElementById("targetAmountInput").value || 0);
      state.profile.targetDate = document.getElementById("targetDateInput").value || "";
      saveState(state);
      closeModal("settingsModal");
      render();
    });

    document.getElementById("expenseForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const state = loadState();
      state.expenses.push({
        amount: Number(document.getElementById("expenseAmount").value || 0),
        category: document.getElementById("expenseCategory").value,
        date: todayISO(),
        note: document.getElementById("expenseNote").value.trim(),
        isPaid: document.getElementById("expensePaid").checked
      });
      saveState(state);
      closeModal("expenseModal");
      e.target.reset();
      document.getElementById("expensePaid").checked = true;
      render();
    });

    document.getElementById("guestForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const state = loadState();
      state.guests.push({
        name: document.getElementById("guestName").value.trim(),
        phone: document.getElementById("guestPhone").value.trim(),
        group: document.getElementById("guestGroup").value,
        rsvp: document.getElementById("guestRsvp").value,
      });
      saveState(state);
      closeModal("guestModal");
      e.target.reset();
      render();
    });

    document.getElementById("bridesmaidForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const state = loadState();
      state.bridesmaids.push({
        name: document.getElementById("bmName").value.trim(),
        phone: document.getElementById("bmPhone").value.trim(),
        notes: document.getElementById("bmNotes").value.trim(),
        status: "pending"
      });
      saveState(state);
      closeModal("bridesmaidModal");
      e.target.reset();
      render();
    });

    // Init
    render();
    go("home");
  </script>
</body>
</html>
